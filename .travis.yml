language: c++

jobs:
    include:
    - os: linux
        compiler: clang
        env:
            # Список переменных окружения, влияющих на матрицу сборки:
            - TARGET_CPU=amd64 BUILD_CONFIGURATION=Debug
            - TARGET_CPU=amd64 BUILD_CONFIGURATION=Release
            - TARGET_CPU=x86 BUILD_CONFIGURATION=Debug
            - TARGET_CPU=x86 BUILD_CONFIGURATION=Release    
        
    - os: osx
        compiler: clang
         env:
            # Список переменных окружения, влияющих на матрицу сборки:
            - TARGET_CPU=amd64 BUILD_CONFIGURATION=Debug
            - TARGET_CPU=amd64 BUILD_CONFIGURATION=Release
            - TARGET_CPU=x86 BUILD_CONFIGURATION=Debug
            - TARGET_CPU=x86 BUILD_CONFIGURATION=Release 
            
    - os: windows
        compiler: msvc
        env:
            # Список переменных окружения, влияющих на матрицу сборки:
            - TARGET_CPU=amd64 BUILD_CONFIGURATION=Debug
            - TARGET_CPU=amd64 BUILD_CONFIGURATION=Release
            - TARGET_CPU=x86 BUILD_CONFIGURATION=Debug
            - TARGET_CPU=x86 BUILD_CONFIGURATION=Release
            
script:
    # Сборочный скрипт
    - mkdir -p build
    - cd build
    - cmake .. -DCMAKE_BUILD_TYPE=$BUILD_CONFIGURATION -DTARGET_CPU=$TARGET_CPU
    - cmake --build .
    #- ctest --output-on-failure
    
